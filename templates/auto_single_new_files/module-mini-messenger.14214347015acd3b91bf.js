/*! For license information please see module-mini-messenger.14214347015acd3b91bf.js.LICENSE.txt */
"use strict";(self["webpackChunkavito_desktop_site"]=self["webpackChunkavito_desktop_site"]||[]).push([[36481],{56814:function(e,t,n){n.r(t),n.d(t,{default:function(){return u}});var r=n(84481),o=n.n(r),a=n(48253),l="index-wrapper-vy8Nq",u=function(){return o().createElement("div",{className:l},o().createElement(a.h,null))}},66955:function(e,t,n){n.d(t,{X:function(){return r}});var r=function(e){return"catalog"===e?window.location.search.includes("map=")?"map":"serp":e||""}},40328:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var r=n(84481),o=n.n(r),a=n(94184),l=n.n(a),u=n(83203),i=n(61741),c=n(90874),s=n(55085),f=n(80814),p=n(66955),d="index-target-QWE1c",m="index-target_hasPush-_oHfM";function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],l=!0,u=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);l=!0);}catch(i){u=!0,o=i}finally{try{l||null==n["return"]||n["return"]()}finally{if(u)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=3e3,b={offset:[0,16]},g={offset:[0,114]},w="mini-messenger/realty-promo-tooltip",S=function(e){var t=(0,u.i)(),n=(0,r.useRef)(!1),a=h((0,r.useState)(!1),2),v=a[0],S=a[1],E=e.itemId,I=e.locationSlug,k=e.needToShow,A=e.page,O=e.tooltipInfo,C=void 0===O?{}:O,P=C.buttonTitle,x=C.text,j=C.url,T=(0,r.useCallback)((function(e){t&&!n.current&&(n.current=!0,t.post("/web/1/developmentsChatBot/closeTooltip",{closeType:e,fromPage:(0,p.X)(A),itemId:E,locationSlug:I},{id:"/web/1/developmentsChatBot/closeTooltip"}))}),[t,E,A,I]),L=h((0,r.useState)(!1),2),H=L[0],M=L[1],N=(0,r.useCallback)((function(){j&&(T("button"),window.location.pathname=j)}),[T,j]);(0,r.useEffect)((function(){M(k)}),[k]),(0,f.O)("app-messenger.realty.promo-tooltip.close",(function(){k&&(M(!1),T("messenger"))})),(0,f.O)("app-messenger.realty.promo-tooltip.messenger-has-push",(function(e){S(e.detail.hasPush)}));var R,U,_,z=(0,r.useCallback)((function(){M(!1),T("cross")}),[T,M]);return o().createElement(i.f,null,o().createElement(c.u,{marker:w,content:x,delayIn:y,actions:o().createElement(s.z,{preset:"defaultInverse",onClick:N},P),maxWidth:210,placement:"top",open:H,closable:!0,animationName:void 0,offset:v?g:b,onClose:z},o().createElement("span",{className:l()(d,(R={},U=m,_=v,U in R?Object.defineProperty(R,U,{value:_,enumerable:!0,configurable:!0,writable:!0}):R[U]=_,R))})))}},81358:function(e,t,n){n.d(t,{Z:function(){return H}});var r=n(24042),o=n.n(r),a=n(84481),l=n(35258),u=n(29363),i=n(99322),c=n(5035),s=n(63123),f=n(64167),p=n(22134),d=n(75766),m=n(83203),h=n(66955);function v(e,t,n,r,o,a,l){try{var u=e[a](l),i=u.value}catch(c){return void n(c)}u.done?t(i):Promise.resolve(i).then(r,o)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function l(e){v(a,r,o,l,u,"next",e)}function u(e){v(a,r,o,l,u,"throw",e)}l(void 0)}))}}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],l=!0,u=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);l=!0);}catch(i){u=!0,o=i}finally{try{l||null==n["return"]||n["return"]()}finally{if(u)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w={needToShow:!1},S=function(e){var t=e.enabled,n=e.fromPage,r=e.itemId,o=e.locationSlug,l=(0,m.i)(),u=(0,f.a)(),i=b((0,a.useState)(w),2),c=i[0],s=i[1],p=(0,a.useCallback)(y(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:if(l&&u){e.next=2;break}return e.abrupt("return",w);case 2:return e.prev=2,e.next=5,l.post("/web/1/developmentsChatBot/getTooltip",{fromPage:(0,h.X)(n),itemId:r,locationSlug:o},{id:"/web/1/developmentsChatBot/getTooltip"});case 5:return t=e.sent,a=t.data,e.abrupt("return",(null==a?void 0:a.result)||w);case 10:e.prev=10,e.t0=e["catch"](2);case 12:return e.abrupt("return",w);case 13:case"end":return e.stop()}}),e,null,[[2,10]])}))),[l,u,n,r,o]);return(0,a.useEffect)((function(){t&&p().then((function(e){s(e)}))}),[t,p]),t?c:void 0},E=n(58598),I="index-layout-WcVLz",k=["itemId","locationSlug","realtyPromoTooltipData","page"];function A(){return A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},A.apply(this,arguments)}function O(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,a=[],l=!0,u=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);l=!0);}catch(i){u=!0,o=i}finally{try{l||null==n["return"]||n["return"]()}finally{if(u)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var x=a.lazy((function(){return Promise.all([n.e(16982),n.e(36481),n.e(85559)]).then(n.bind(n,40328)).then((function(e){return{default:o()(e.default,"components-RealtyPromoTooltip")}}))})),j=a.lazy((function(){return Promise.all([n.e(36481),n.e(52268)]).then(n.bind(n,56814)).then((function(e){return{default:o()(e.default,"components-CallNotification")}}))})),T={bottom:32,right:10},L=function(e){var t=e.itemId,n=e.locationSlug,r=e.realtyPromoTooltipData,o=e.page,l=O(e,k),u={isHashRotateEnabled:l.isHashRotateEnabled,isHostLocalhost:l.isHostLocalhost,abCentral:l.abCentral,hostAppName:l.hostAppName,userIdHash:l.userIdHash,externalLocation:l.externalLocation,avitoUrl:l.avitoUrl},i=a.createElement(E.i,u);return r?a.createElement("div",null,a.createElement(a.Suspense,{fallback:null},a.createElement(x,A({itemId:t,locationSlug:n,page:o},r))),i):i},H=(0,c.Z)((function(){return(0,s.Z)((function(e){var t=e.page,n=e.match;return function(e){var r,o,i=e.withRealtyPromoTooltip,c=(0,u.x)(),s=(0,f.a)(),p=(0,l.useLocation)(),m=null==n||null===(r=n.params)||void 0===r?void 0:r.itemId,h=m?Number(m):void 0,v=null==n||null===(o=n.params)||void 0===o?void 0:o.location,y=S({enabled:i,fromPage:t.id,itemId:h,locationSlug:v}),b=function(){var e=C(a.useState(!1),2),t=e[0],n=e[1],r=a.useCallback((function(e){switch(e.type){case"geo-search:fullMapLoad":n(!0);break;case"geo-search:fullMapUnload":n(!1)}}),[]);return a.useEffect((function(){return document.addEventListener("geo-search:fullMapLoad",r),document.addEventListener("geo-search:fullMapUnload",r),function(){document.removeEventListener("geo-search:fullMapLoad",r),document.removeEventListener("geo-search:fullMapUnload",r)}}),[r]),t}(),g=C(a.useState(!1),2),w=g[0],E=g[1];if(a.useEffect((function(){E(!0)}),[]),!w||!s)return null;var k=b?T:void 0;return a.createElement(d.Z,{user:s},(function(e){return a.createElement("div",{className:I,style:k,"data-marker":"mini-messenger"},a.createElement(a.Suspense,{fallback:null},a.createElement(j,null)),a.createElement(L,{hostAppName:"desktop",isHostLocalhost:"production"=="development",isHashRotateEnabled:e.isHashRotateEnabled,userIdHash:e.userIdHash,fromPage:t.id,avitoUrl:window.location.origin,abCentral:c,externalLocation:p,itemId:h,locationSlug:v,page:t.id,realtyPromoTooltipData:y}))}))}}))}),[i.O,p.H])}}]);